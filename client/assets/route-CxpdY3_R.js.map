{"version":3,"file":"route-CxpdY3_R.js","sources":["../../../app/components/ui/card.tsx","../../../node_modules/.pnpm/lucide-react@0.468.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/chevron-left.js","../../../app/routes/_onboard.otp/route.tsx"],"sourcesContent":["import * as React from \"react\";\n\nimport { cn } from \"@/lib/util\";\n\nconst Card = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n   ({ className, ...props }, ref) => (\n      <div\n         ref={ref}\n         className={cn(\"rounded-xl border bg-card text-card-foreground shadow\", className)}\n         {...props}\n      />\n   ),\n);\nCard.displayName = \"Card\";\n\nconst CardHeader = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n   ({ className, ...props }, ref) => (\n      <div ref={ref} className={cn(\"flex flex-col space-y-1.5 p-6\", className)} {...props} />\n   ),\n);\nCardHeader.displayName = \"CardHeader\";\n\nconst CardTitle = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n   ({ className, ...props }, ref) => (\n      <div\n         ref={ref}\n         className={cn(\"font-semibold leading-none tracking-tight\", className)}\n         {...props}\n      />\n   ),\n);\nCardTitle.displayName = \"CardTitle\";\n\nconst CardDescription = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n   ({ className, ...props }, ref) => (\n      <div ref={ref} className={cn(\"text-sm text-muted-foreground\", className)} {...props} />\n   ),\n);\nCardDescription.displayName = \"CardDescription\";\n\nconst CardContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n   ({ className, ...props }, ref) => (\n      <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n   ),\n);\nCardContent.displayName = \"CardContent\";\n\nconst CardFooter = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n   ({ className, ...props }, ref) => (\n      <div ref={ref} className={cn(\"flex items-center p-6 pt-0\", className)} {...props} />\n   ),\n);\nCardFooter.displayName = \"CardFooter\";\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent };\n","/**\n * @license lucide-react v0.468.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ChevronLeft = createLucideIcon(\"ChevronLeft\", [\n  [\"path\", { d: \"m15 18-6-6 6-6\", key: \"1wnfg3\" }]\n]);\n\nexport { ChevronLeft as default };\n//# sourceMappingURL=chevron-left.js.map\n","import { api } from \"@/api/api\";\nimport { errorResponse } from \"@/api/util\";\nimport AsyncImg from \"@/components/async-img\";\nimport { FormError } from \"@/components/form-error\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { useSession } from \"@/hooks/use-session\";\nimport log from \"@/lib/logger\";\nimport { cn } from \"@/lib/util\";\nimport { getSecureCookie, setSecureCookie } from \"@/sessions\";\nimport { useForm } from \"@conform-to/react\";\nimport { parseWithZod } from \"@conform-to/zod\";\nimport {\n   type ClientActionFunctionArgs,\n   Form,\n   Link,\n   useActionData,\n   useNavigate,\n} from \"@remix-run/react\";\nimport { ChevronLeft } from \"lucide-react\";\nimport { useEffect, useState } from \"react\";\nimport { z } from \"zod\";\n\nconst schema = z.object({\n   code: z.string(),\n});\n\nexport const clientAction = async ({ request }: ClientActionFunctionArgs) => {\n   const formData = await request.formData();\n   try {\n      const submission = parseWithZod(formData, { schema });\n\n      const code = formData.get(\"code\")?.valueOf().toString();\n      const email = getSecureCookie(\"email\");\n      if (!code || !email) {\n         return submission.reply({ formErrors: [\"Submission error\"] });\n      }\n      const { accessToken, refreshToken } = (await api.confirmOtp({ email, code })).data;\n      if (!accessToken || !refreshToken) {\n         return submission.reply({ formErrors: [\"Submission error\"] });\n      }\n      log.info(\"new accessToken set:\", accessToken);\n      log.info(\"new refreshToken set:\", refreshToken);\n      setSecureCookie(\"access\", accessToken);\n      setSecureCookie(\"refresh\", refreshToken, { expires: 30 });\n      return submission.reply();\n   } catch (error) {\n      return errorResponse({ formData, schema, error });\n   }\n};\n\nexport default function VerifyOtpPage() {\n   const vm = VerifyOtpViewModel();\n\n   return (\n      <div className=\"min-h-[calc(100vh-136px)] flex items-center justify-center p-4\">\n         <div className=\"w-full max-w-[1200px] grid md:grid-cols-2 gap-8 items-center\">\n            <div className=\"w-full max-w-md mx-auto space-y-8\">\n               <Card className=\"w-full\">\n                  <CardHeader className=\"space-y-1 text-center\">\n                     <CardTitle className=\"text-2xl\">OTP Verification</CardTitle>\n                     <p className=\"text-sm text-gray-500\">\n                        Enter OTP we will send to example@email.com\n                     </p>\n                  </CardHeader>\n                  <CardContent>\n                     <Form\n                        method=\"post\"\n                        id={vm.form.id}\n                        onSubmit={vm.form.onSubmit}\n                        className=\"space-y-6\"\n                     >\n                        <div className=\"flex justify-center space-x-4\">\n                           <Input\n                              name={vm.fields.code.name}\n                              type=\"text\"\n                              inputMode=\"numeric\"\n                              pattern=\"[0-9]*\"\n                              maxLength={7}\n                              style={{ fontSize: \"18px\" }}\n                              onChange={vm.handleInputChange}\n                              className=\"w-64 h-12 text-center font-semibold tracking-widest text-gray-600\"\n                              value={vm.otp}\n                           />\n                        </div>\n                        <div className=\"text-center\">\n                           {vm.fields.code.errors && <FormError errors={vm.fields.code.errors} />}\n                        </div>\n                        <Button\n                           type=\"submit\"\n                           className={cn(\"w-64 bg-purple-600 hover:bg-purple-700 mx-auto flex\", {\n                              \"opacity-50\": vm.isSubmitting,\n                           })}\n                           disabled={vm.isSubmitting}\n                        >\n                           Confirm\n                        </Button>\n                        <div className=\"text-center\">\n                           <Link\n                              to=\"/sign-in\"\n                              className=\"inline-flex items-center text-sm text-gray-600 hover:text-gray-900\"\n                           >\n                              <ChevronLeft className=\"w-4 h-4 mr-1\" />\n                              Back to log in\n                           </Link>\n                        </div>\n                     </Form>\n                  </CardContent>\n               </Card>\n            </div>\n            <div className=\"hidden md:block relative h-full min-h-[600px] rounded-3xl overflow-hidden bg-gradient-to-br from-purple-500 to-purple-700\">\n               <AsyncImg\n                  src=\"https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?w=800&h=1200&fit=crop\"\n                  alt=\"OTP Verification\"\n                  className=\"object-cover opacity-80 h-full w-full\"\n               />\n            </div>\n         </div>\n      </div>\n   );\n}\n\nconst VerifyOtpViewModel = () => {\n   const action = useActionData<typeof clientAction>();\n   const [otp, setOtp] = useState<string>(\"\");\n\n   const navigate = useNavigate();\n   const session = useSession();\n\n   const isSubmitting = action?.status === \"success\"\n\n   const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n      const newOtp = e.target.value.replace(/[^0-9]/g, \"\");\n      setOtp(newOtp);\n   };\n\n   useEffect(() => {\n      if (session.isSignedIn) setTimeout(() => navigate(\"/\"), 150);\n   }, [session.isSignedIn]);\n\n   if (isSubmitting) {\n      const accessToken = getSecureCookie(\"access\");\n      const refreshToken = getSecureCookie(\"refresh\");\n      if (accessToken && refreshToken) {\n         session.signIn(accessToken)\n      }\n   }\n\n   const [form, fields] = useForm({\n      id: \"otp-signin\",\n      onValidate({ formData }) {\n         return parseWithZod(formData, { schema });\n      },\n      lastResult: action,\n      shouldRevalidate: \"onBlur\",\n   });\n\n   return {\n      action,\n      otp,\n      handleInputChange,\n      form,\n      fields,\n      isSubmitting,\n   };\n};\n"],"names":["Card","React.forwardRef","className","props","ref","jsx","cn","CardHeader","CardTitle","CardDescription","CardContent","CardFooter","ChevronLeft","createLucideIcon","schema","z","object","code","string","clientAction","request","formData","submission","parseWithZod","get","valueOf","toString","email","getSecureCookie","reply","formErrors","accessToken","refreshToken","api","confirmOtp","data","log","info","setSecureCookie","expires","error","errorResponse","VerifyOtpPage","vm","VerifyOtpViewModel","children","jsxs","Form","method","id","form","onSubmit","Input","name","fields","type","inputMode","pattern","maxLength","style","fontSize","onChange","handleInputChange","value","otp","errors","FormError","Button","isSubmitting","disabled","Link","to","AsyncImg","src","alt","action","useActionData","setOtp","useState","navigate","useNavigate","session","useSession","status","e","newOtp","target","replace","useEffect","isSignedIn","setTimeout","signIn","useForm","onValidate","lastResult","shouldRevalidate"],"mappings":"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","x_google_ignoreList":[1]}