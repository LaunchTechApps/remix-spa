import{r as i,j as t,z as C,p as P,a as _,b as H,l as z,e as T}from"./sessions-C57l87vz.js";import{F as N,A as U,u as q}from"./hooks-C6qM7KG3.js";import{u as K}from"./use-toast-BQb0c899.js";import{I as J,B as V}from"./input-Bevw-_z8.js";import{v as R,F as X,w as $,x as Y,y as Z,z as G}from"./components-CBt2hBVj.js";import{f as Q,c as ee,u as te,a as re,P as A,e as I,b as se}from"./index-CCf4LlvD.js";import{C as oe}from"./react-icons.esm-JaXArfXD.js";import{u as ae}from"./use-session-mo2QWco5.js";import"./index-Bb4qSo10.js";function ie(e){const s=i.useRef({value:e,previous:e});return i.useMemo(()=>(s.current.value!==e&&(s.current.previous=s.current.value,s.current.value=e),s.current.previous),[e])}function ne(e){const[s,r]=i.useState(void 0);return Q(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let l,c;if("borderBoxSize"in o){const m=o.borderBoxSize,f=Array.isArray(m)?m[0]:m;l=f.inlineSize,c=f.blockSize}else l=e.offsetWidth,c=e.offsetHeight;r({width:l,height:c})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),s}var w="Checkbox",[ce,Ce]=ee(w),[le,de]=ce(w),D=i.forwardRef((e,s)=>{const{__scopeCheckbox:r,name:n,checked:a,defaultChecked:o,required:l,disabled:c,value:m="on",onCheckedChange:f,form:d,...v}=e,[p,g]=i.useState(null),y=te(s,u=>g(u)),k=i.useRef(!1),E=p?d||!!p.closest("form"):!0,[x=!1,j]=re({prop:a,defaultProp:o,onChange:f}),F=i.useRef(x);return i.useEffect(()=>{const u=p==null?void 0:p.form;if(u){const b=()=>j(F.current);return u.addEventListener("reset",b),()=>u.removeEventListener("reset",b)}},[p,j]),t.jsxs(le,{scope:r,state:x,disabled:c,children:[t.jsx(A.button,{type:"button",role:"checkbox","aria-checked":h(x)?"mixed":x,"aria-required":l,"data-state":L(x),"data-disabled":c?"":void 0,disabled:c,value:m,...v,ref:y,onKeyDown:I(e.onKeyDown,u=>{u.key==="Enter"&&u.preventDefault()}),onClick:I(e.onClick,u=>{j(b=>h(b)?!0:!b),E&&(k.current=u.isPropagationStopped(),k.current||u.stopPropagation())})}),E&&t.jsx(ue,{control:p,bubbles:!k.current,name:n,value:m,checked:x,required:l,disabled:c,form:d,style:{transform:"translateX(-100%)"},defaultChecked:h(o)?!1:o})]})});D.displayName=w;var O="CheckboxIndicator",B=i.forwardRef((e,s)=>{const{__scopeCheckbox:r,forceMount:n,...a}=e,o=de(O,r);return t.jsx(se,{present:n||h(o.state)||o.state===!0,children:t.jsx(A.span,{"data-state":L(o.state),"data-disabled":o.disabled?"":void 0,...a,ref:s,style:{pointerEvents:"none",...e.style}})})});B.displayName=O;var ue=e=>{const{control:s,checked:r,bubbles:n=!0,defaultChecked:a,...o}=e,l=i.useRef(null),c=ie(r),m=ne(s);i.useEffect(()=>{const d=l.current,v=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(v,"checked").set;if(c!==r&&g){const y=new Event("click",{bubbles:n});d.indeterminate=h(r),g.call(d,h(r)?!1:r),d.dispatchEvent(y)}},[c,r,n]);const f=i.useRef(h(r)?!1:r);return t.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??f.current,...o,tabIndex:-1,ref:l,style:{...e.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function h(e){return e==="indeterminate"}function L(e){return h(e)?"indeterminate":e?"checked":"unchecked"}var M=D,me=B;const W=i.forwardRef(({className:e,...s},r)=>t.jsx(M,{ref:r,className:R("peer h-4 w-4 shrink-0 rounded-sm  border-gray-300 focus:ring-purple-500 border shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...s,children:t.jsx(me,{className:R("flex items-center justify-center text-current bg-purple-600 rounded"),children:t.jsx(oe,{className:"h-4 w-4"})})}));W.displayName=M.displayName;const S=C.object({email:C.string().email("Please provide a valid email address.").nonempty("Email is required."),checkbox:C.boolean()}),Se=async({request:e})=>{var n;const s=await e.formData(),r=P(s,{schema:S});try{const a=(n=s.get("email"))==null?void 0:n.valueOf().toString();return a?(await _.registerWaitlist({email:a}),r.reply()):r.reply({formErrors:["Submission error"]})}catch(a){const o=await H(a);return o!=null&&o.friendlyMsg?{formErrors:["Email is required."],status:"error",error:{friendlyError:o.friendlyMsg}}:(z.error("Error during client action",{error:o}),T({formData:s,schema:S,error:a}))}},we=async()=>({imageUrl:(async()=>(await new Promise(r=>setTimeout(r,0)),"https://images.unsplash.com/photo-1542772144-515ddfae17e9"))()});function Ee(){const e=fe();return t.jsx("div",{className:"min-h-[calc(100vh-136px)] flex items-center justify-center p-4",children:t.jsxs("div",{className:"w-full max-w-[1200px] grid md:grid-cols-2 gap-8 items-center",children:[t.jsxs("div",{className:"w-full max-w-md mx-auto space-y-6",children:[t.jsxs("div",{className:"space-y-2 text-center",children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"EARLY ACCESS"}),t.jsx("p",{className:"text-gray-500",children:"Join the waitlist"})]}),t.jsx(X,{method:"post",id:e.form.id,onSubmit:e.form.onSubmit,className:"space-y-6",children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"space-y-2",children:t.jsxs("div",{className:"relative",children:[t.jsx(J,{name:e.fields.email.name,type:"email",placeholder:"your@email.com",className:"pl-5 py-6 bg-gray-50/50"}),t.jsx(N,{errors:e.fields.email.errors})]})}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(W,{name:e.fields.checkbox.name,id:"agree",className:"h-4 w-4"}),t.jsx("label",{htmlFor:"agree",className:"text-xs font-medium text-gray-700",children:"I agree to receive marketing emails & special deals"})]}),t.jsx(N,{errors:e.fields.checkbox.errors}),t.jsx("div",{className:"h-12"}),t.jsx(V,{type:"submit",disabled:e.isSubmitting,className:"w-full py-6 bg-purple-600 hover:bg-purple-700",children:"JOIN NOW"})]})}),t.jsx("hr",{}),t.jsxs("div",{className:"text-center text-sm",children:["Already have an account?"," ",t.jsx($,{to:"/sign-in",className:"text-purple-600 hover:text-purple-700 font-semibold",children:"Sign In"})]})]}),t.jsx("div",{className:"hidden md:block relative h-full min-h-[600px] rounded-3xl overflow-hidden bg-gradient-to-br from-purple-500 to-purple-700",children:t.jsx(U,{src:e.imageUrl,alt:"Street art",className:"object-cover opacity-80 w-full h-full"})})]})})}const fe=()=>{const e=Y(),[s,r]=i.useState(!1),{imageUrl:n}=Z();let a=(e==null?void 0:e.status)||"";const o=G(),l=ae(),{toast:c}=K();i.useEffect(()=>{l.isSignedIn&&o("/")},[l.isSignedIn]);const[m,f]=q({id:"waitlist-register",onValidate({formData:d}){return P(d,{schema:S})},onSubmit(){r(!0),setTimeout(()=>r(!1),2e3)},lastResult:e,shouldRevalidate:"onBlur"});return i.useEffect(()=>{var d;a==="success"&&(z.info("WORKED!"),c({description:`Success! added '${f.email.value}' to the waitlist`})),(d=e==null?void 0:e.error)!=null&&d.friendlyError&&c({variant:"destructive",description:e.error.friendlyError})},[a]),{action:e,form:m,fields:f,isSubmitting:s,imageUrl:n}};export{Se as clientAction,we as clientLoader,Ee as default};
