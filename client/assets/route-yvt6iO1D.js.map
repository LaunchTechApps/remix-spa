{"version":3,"file":"route-yvt6iO1D.js","sources":["../../../node_modules/.pnpm/@remix-run+server-runtime@2.15.2_typescript@5.7.2/node_modules/@remix-run/server-runtime/dist/esm/responses.js","../../../app/routes/_onboard.sign-in/route.tsx"],"sourcesContent":["/**\n * @remix-run/server-runtime v2.15.2\n *\n * Copyright (c) Remix Software Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE.md file in the root directory of this source tree.\n *\n * @license MIT\n */\nimport { json as json$1, defer as defer$1, redirect as redirect$1, replace as replace$1, redirectDocument as redirectDocument$1 } from '@remix-run/router';\nimport { serializeError } from './errors.js';\n\n// must be a type since this is a subtype of response\n// interfaces must conform to the types they extend\n\n/**\n * This is a shortcut for creating `application/json` responses. Converts `data`\n * to JSON and sets the `Content-Type` header.\n *\n * @deprecated This utility is deprecated in favor of opting into Single Fetch\n * via `future.v3_singleFetch` and returning raw objects.  This method will be\n * removed in React Router v7.  If you need to return a JSON Response, you can\n * use `Response.json()`.\n *\n * @see https://remix.run/utils/json\n */\nconst json = (data, init = {}) => {\n  return json$1(data, init);\n};\n\n/**\n * This is a shortcut for creating Remix deferred responses\n *\n * @deprecated This utility is deprecated in favor of opting into Single Fetch\n * via `future.v3_singleFetch` and returning raw objects.  This method will be\n * removed in React Router v7.\n *\n * @see https://remix.run/utils/defer\n */\nconst defer = (data, init = {}) => {\n  return defer$1(data, init);\n};\n/**\n * A redirect response. Sets the status code and the `Location` header.\n * Defaults to \"302 Found\".\n *\n * @see https://remix.run/utils/redirect\n */\nconst redirect = (url, init = 302) => {\n  return redirect$1(url, init);\n};\n\n/**\n * A redirect response. Sets the status code and the `Location` header.\n * Defaults to \"302 Found\".\n *\n * @see https://remix.run/utils/redirect\n */\nconst replace = (url, init = 302) => {\n  return replace$1(url, init);\n};\n\n/**\n * A redirect response that will force a document reload to the new location.\n * Sets the status code and the `Location` header.\n * Defaults to \"302 Found\".\n *\n * @see https://remix.run/utils/redirect\n */\nconst redirectDocument = (url, init = 302) => {\n  return redirectDocument$1(url, init);\n};\nfunction isDeferredData(value) {\n  let deferred = value;\n  return deferred && typeof deferred === \"object\" && typeof deferred.data === \"object\" && typeof deferred.subscribe === \"function\" && typeof deferred.cancel === \"function\" && typeof deferred.resolveData === \"function\";\n}\nfunction isResponse(value) {\n  return value != null && typeof value.status === \"number\" && typeof value.statusText === \"string\" && typeof value.headers === \"object\" && typeof value.body !== \"undefined\";\n}\nconst redirectStatusCodes = new Set([301, 302, 303, 307, 308]);\nfunction isRedirectStatusCode(statusCode) {\n  return redirectStatusCodes.has(statusCode);\n}\nfunction isRedirectResponse(response) {\n  return isRedirectStatusCode(response.status);\n}\nfunction isTrackedPromise(value) {\n  return value != null && typeof value.then === \"function\" && value._tracked === true;\n}\n\n// TODO: Figure out why ReadableStream types are borked sooooooo badly\n// in this file. Probably related to our TS configurations and configs\n// bleeding into each other.\nconst DEFERRED_VALUE_PLACEHOLDER_PREFIX = \"__deferred_promise:\";\nfunction createDeferredReadableStream(deferredData, signal, serverMode) {\n  let encoder = new TextEncoder();\n  let stream = new ReadableStream({\n    async start(controller) {\n      let criticalData = {};\n      let preresolvedKeys = [];\n      for (let [key, value] of Object.entries(deferredData.data)) {\n        if (isTrackedPromise(value)) {\n          criticalData[key] = `${DEFERRED_VALUE_PLACEHOLDER_PREFIX}${key}`;\n          if (typeof value._data !== \"undefined\" || typeof value._error !== \"undefined\") {\n            preresolvedKeys.push(key);\n          }\n        } else {\n          criticalData[key] = value;\n        }\n      }\n\n      // Send the critical data\n      controller.enqueue(encoder.encode(JSON.stringify(criticalData) + \"\\n\\n\"));\n      for (let preresolvedKey of preresolvedKeys) {\n        enqueueTrackedPromise(controller, encoder, preresolvedKey, deferredData.data[preresolvedKey], serverMode);\n      }\n      let unsubscribe = deferredData.subscribe((aborted, settledKey) => {\n        if (settledKey) {\n          enqueueTrackedPromise(controller, encoder, settledKey, deferredData.data[settledKey], serverMode);\n        }\n      });\n      await deferredData.resolveData(signal);\n      unsubscribe();\n      controller.close();\n    }\n  });\n  return stream;\n}\nfunction enqueueTrackedPromise(controller, encoder, settledKey, promise, serverMode) {\n  if (\"_error\" in promise) {\n    controller.enqueue(encoder.encode(\"error:\" + JSON.stringify({\n      [settledKey]: promise._error instanceof Error ? serializeError(promise._error, serverMode) : promise._error\n    }) + \"\\n\\n\"));\n  } else {\n    controller.enqueue(encoder.encode(\"data:\" + JSON.stringify({\n      [settledKey]: promise._data ?? null\n    }) + \"\\n\\n\"));\n  }\n}\n\nexport { createDeferredReadableStream, defer, isDeferredData, isRedirectResponse, isRedirectStatusCode, isResponse, json, redirect, redirectDocument, replace };\n","import { api } from \"@/api/api\";\nimport { getErrorResponse } from \"@/api/util\";\nimport AsyncImg from \"@/components/async-img\";\nimport { FormError } from \"@/components/form-error\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { cn } from \"@/lib/util\";\nimport { getSecureCookie, setSecureCookie } from \"@/sessions\";\nimport { useForm } from \"@conform-to/react\";\nimport { parseWithZod } from \"@conform-to/zod\";\nimport {\n   type ClientActionFunctionArgs,\n   Form,\n   Link,\n   redirect,\n   useActionData,\n   useLoaderData,\n   useNavigation,\n} from \"@remix-run/react\";\nimport { z } from \"zod\";\n\nconst schema = z.object({\n   email: z.string().email(),\n});\n\nexport const clientAction = async ({ request }: ClientActionFunctionArgs) => {\n   const formData = await request.formData();\n   const submission = parseWithZod(formData, { schema });\n   try {\n      const email = formData.get(\"email\")?.valueOf().toString();\n      if (!email) return submission.reply({ formErrors: [\"Email was not submitted\"] });\n      await api.requestOtp({ email });\n      setSecureCookie(\"email\", email);\n   } catch (error) {\n      const errRes = await getErrorResponse(error);\n      if (errRes && errRes.friendlyMsg !== undefined) {\n         return submission.reply({ formErrors: [errRes.friendlyMsg] });\n      }\n      return submission.reply({ formErrors: [\"Unknown error\"] });\n   }\n\n   return redirect(\"/otp\");\n};\n\nexport const clientLoader = async () => {\n   const getImg = async () => {\n      await new Promise((resolve) => setTimeout(resolve, 0));\n      const imageUrl = \"https://images.unsplash.com/photo-1546930722-a1292ed9dee8\";\n      return imageUrl;\n   };\n\n   if (getSecureCookie(\"access\")) {\n      return redirect(\"/\");\n   }\n   return { imageUrl: getImg() };\n};\n\nexport default function SignInPage() {\n   const { imageUrl } = useLoaderData<typeof clientLoader>();\n   const action = useActionData<typeof clientAction>();\n   const navigation = useNavigation();\n\n   const [form, fields] = useForm({\n      id: \"sign-in\",\n      onValidate({ formData }) {\n         return parseWithZod(formData, { schema });\n      },\n      lastResult: action,\n      shouldRevalidate: \"onBlur\",\n   });\n\n   return (\n      <div className=\"min-h-[calc(100vh-136px)] flex items-center justify-center p-4\">\n         <div className=\"w-full max-w-[1200px] grid md:grid-cols-2 gap-8 items-center\">\n            <div className=\"w-full max-w-md mx-auto space-y-6\">\n               <div className=\"space-y-2 text-center\">\n                  <h1 className=\"text-3xl font-bold tracking-tight\">LOGIN</h1>\n                  <p className=\"text-gray-500\">Enter your email to receive a login code</p>\n               </div>\n               <div className=\"space-y-4\">\n                  <Form method=\"post\" id={form.id} onSubmit={form.onSubmit}>\n                     <div className=\"space-y-2\">\n                        <div className=\"relative\">\n                           <Input\n                              name={fields.email.name}\n                              id=\"email\"\n                              type=\"text\"\n                              placeholder=\"your@email.com\"\n                              className=\"pl-5 py-6 bg-gray-50/50\"\n                           />\n                           {fields.email.errors && <FormError errors={fields.email.errors} />}\n                        </div>\n                     </div>\n                     <FormError errors={form.errors} />\n                     <div className=\"h-5\" />\n                     <Button\n                        type=\"submit\"\n                        disabled={navigation.state === \"submitting\"}\n                        className={cn(\"w-full py-6 bg-purple-600 hover:bg-purple-700\", {\n                           \"opacity-40\": navigation.state === \"submitting\",\n                        })}\n                     >\n                        Send Login Code\n                     </Button>\n                  </Form>\n               </div>\n\n               <hr />\n               <div className=\"text-center text-sm\">\n                  Don&apos;t have an account?{\" \"}\n                  <Link\n                     to=\"/waitlist\"\n                     className=\"text-purple-600 hover:text-purple-700 font-semibold\"\n                  >\n                     Join the waitlist\n                  </Link>\n               </div>\n            </div>\n            <div className=\"hidden md:block relative h-full min-h-[600px] rounded-3xl overflow-hidden bg-gradient-to-br from-purple-500 to-purple-700\">\n               <AsyncImg\n                  src={imageUrl}\n                  alt=\"Street art\"\n                  className=\"object-cover opacity-80 w-full h-full\"\n               />\n            </div>\n         </div>\n      </div>\n   );\n}\n"],"names":["redirect","url","init","redirect$1","schema","z","object","email","string","clientAction","request","formData","submission","parseWithZod","get","valueOf","toString","reply","formErrors","api","requestOtp","setSecureCookie","error","errRes","getErrorResponse","friendlyMsg","clientLoader","getImg","Promise","resolve","setTimeout","getSecureCookie","imageUrl","SignInPage","useLoaderData","action","useActionData","navigation","useNavigation","form","fields","useForm","id","onValidate","lastResult","shouldRevalidate","className","children","jsxs","jsx","Form","method","onSubmit","Input","name","type","placeholder","errors","FormError","Button","disabled","state","cn","Link","to","AsyncImg","src","alt"],"mappings":"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","x_google_ignoreList":[0]}