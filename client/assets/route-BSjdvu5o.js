import{n as e,F as j,w,y as v,r as u,A as y}from"./components-ugrZxUQv.js";import{z as x,p as g,a as N,e as b}from"./util-xzq6sDsx.js";import{A as k}from"./async-img-CXjFLSRl.js";import{F as C,u as S}from"./hooks-DVZMzx8b.js";import{B as T}from"./button-D7gDO4Um.js";import{a as O,b as I,c as E,d as V,C as A}from"./card-D_Ubfsvc.js";import{I as F}from"./input-Be7u5qEb.js";import{u as B}from"./use-session-VN7Ppq8x.js";import{g as d,l as f,s as h}from"./sessions-etKJw0ug.js";import"./util-B9sxEhC4.js";import"./createLucideIcon-DQDqlXhP.js";const K={showSearch:!1,showNavLinks:!1},p=x.object({code:x.string()}),Q=async({request:s})=>{var c;const o=await s.formData();try{const t=g(o,{schema:p}),r=(c=o.get("code"))==null?void 0:c.valueOf().toString(),l=d("email");if(!r||!l)return t.reply({formErrors:["Submission error"]});const{accessToken:n,refreshToken:i}=(await N.confirmOtp({email:l,code:r})).data;return!n||!i?t.reply({formErrors:["Submission error"]}):(f.info("new accessToken set:",n),f.info("new refreshToken set:",i),h("access",n),h("refresh",i,{expires:30}),t.reply())}catch(t){return b({formData:o,schema:p,error:t})}};function U(){const s=L();return e.jsx("div",{className:"min-h-[calc(100vh-136px)] flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-[1200px] grid md:grid-cols-2 gap-8 items-center",children:[e.jsx("div",{className:"w-full max-w-md mx-auto space-y-8",children:e.jsxs(O,{className:"w-full",children:[e.jsxs(I,{className:"space-y-1 text-center",children:[e.jsx(E,{className:"text-2xl",children:"OTP Verification"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enter OTP we will send to useradmit@gmail.com"})]}),e.jsx(V,{children:e.jsxs(j,{method:"post",id:s.form.id,onSubmit:s.form.onSubmit,className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center space-x-4",children:e.jsx(F,{name:s.fields.code.name,type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:7,style:{fontSize:"18px"},onChange:s.handleInputChange,className:"w-64 h-12 text-center font-semibold tracking-widest text-gray-600",value:s.otp})}),e.jsx("div",{className:"text-center",children:s.fields.code.errors&&e.jsx(C,{errors:s.fields.code.errors})}),e.jsx(T,{type:"submit",className:"w-64 bg-purple-600 hover:bg-purple-700 mx-auto flex",children:"Confirm"}),e.jsx("div",{className:"text-center",children:e.jsxs(w,{to:"/sign-in",className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900",children:[e.jsx(A,{className:"w-4 h-4 mr-1"}),"Back to log in"]})})]})})]})}),e.jsx("div",{className:"hidden md:block relative h-full min-h-[600px] rounded-3xl overflow-hidden bg-gradient-to-br from-purple-500 to-purple-700",children:e.jsx(k,{src:"https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?w=800&h=1200&fit=crop",alt:"OTP Verification",className:"object-cover opacity-80 h-full w-full"})})]})})}const L=()=>{const s=v(),[o,c]=u.useState(""),t=y(),r=B(),l=a=>{const m=a.target.value.replace(/[^0-9]/g,"");c(m)};if(u.useEffect(()=>{r.isSignedIn&&t("/")},[r.isSignedIn]),(s==null?void 0:s.status)==="success"){const a=d("access"),m=d("refresh");a&&m&&r.signIn(a)}f.debug(r);const[n,i]=S({id:"otp-signin",onValidate({formData:a}){return g(a,{schema:p})},lastResult:s,shouldRevalidate:"onBlur"});return{action:s,otp:o,handleInputChange:l,form:n,fields:i}};export{Q as clientAction,U as default,K as handle};
