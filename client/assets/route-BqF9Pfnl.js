import{y as g,r as j,A as w,n as e,F as v,w as y}from"./components-ugrZxUQv.js";import{B as N}from"./button-D7gDO4Um.js";import{I as b}from"./input-Be7u5qEb.js";import{a as k,b as C,c as S,d as T,C as O}from"./card-D_Ubfsvc.js";import{A as E}from"./async-img-CXjFLSRl.js";import{z as f,p as h,a as A,e as F}from"./util-BTPqJzjT.js";import{u as I,F as P}from"./hooks-EShdq0qB.js";import{g as d,l as u,s as x}from"./sessions-BkRY5YvT.js";import{u as B}from"./use-session-BBrTJGp8.js";import"./util-B9sxEhC4.js";import"./createLucideIcon-DQDqlXhP.js";const J={showSearch:!1,showNavLinks:!1},p=f.object({code:f.string()}),K=async({request:t})=>{var i;const n=await t.formData();try{const s=h(n,{schema:p}),c=(i=n.get("code"))==null?void 0:i.valueOf().toString(),l=d("email");if(!c||!l)return s.reply({formErrors:["Submission error"]});const{accessToken:a,refreshToken:r}=(await A.confirmOtp({email:l,code:c})).data;return!a||!r?s.reply({formErrors:["Submission error"]}):(u.info("new accessToken set:",a),u.info("new refreshToken set:",r),x("access",a),x("refresh",r,{expires:30}),s.reply())}catch(s){return F({formData:n,schema:p,error:s})}};function Q(){const t=g(),[n,i]=j.useState(""),s=w(),c=B(),l=o=>{const m=o.target.value.replace(/[^0-9]/g,"");i(m)};if((t==null?void 0:t.status)==="success"){const o=d("access"),m=d("refresh");o&&m&&(c.signIn(o),s("/"))}const[a,r]=I({id:"otp-signin",onValidate({formData:o}){return h(o,{schema:p})},lastResult:t,shouldRevalidate:"onBlur"});return e.jsx("div",{className:"min-h-[calc(100vh-136px)] flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-[1200px] grid md:grid-cols-2 gap-8 items-center",children:[e.jsx("div",{className:"w-full max-w-md mx-auto space-y-8",children:e.jsxs(k,{className:"w-full",children:[e.jsxs(C,{className:"space-y-1 text-center",children:[e.jsx(S,{className:"text-2xl",children:"OTP Verification"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enter OTP we will send to useradmit@gmail.com"})]}),e.jsx(T,{children:e.jsxs(v,{method:"post",id:a.id,onSubmit:a.onSubmit,className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center space-x-4",children:e.jsx(b,{name:r.code.name,type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:7,style:{fontSize:"18px"},onChange:l,className:"w-64 h-12 text-center font-semibold tracking-widest text-gray-600",value:n})}),e.jsx("div",{className:"text-center",children:r.code.errors&&e.jsx(P,{errors:r.code.errors})}),e.jsx(N,{type:"submit",className:"w-64 bg-purple-600 hover:bg-purple-700 mx-auto flex",children:"Confirm"}),e.jsx("div",{className:"text-center",children:e.jsxs(y,{to:"/sign-in",className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900",children:[e.jsx(O,{className:"w-4 h-4 mr-1"}),"Back to log in"]})})]})})]})}),e.jsx("div",{className:"hidden md:block relative h-full min-h-[600px] rounded-3xl overflow-hidden bg-gradient-to-br from-purple-500 to-purple-700",children:e.jsx(E,{src:"https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?w=800&h=1200&fit=crop",alt:"OTP Verification",className:"object-cover opacity-80 h-full w-full"})})]})})}export{K as clientAction,Q as default,J as handle};
